---
jupytext:
  text_representation:
    extension: .md
    format_name: myst
    format_version: 0.13
    jupytext_version: 1.13.0
kernelspec:
  display_name: Python 3 (ipykernel)
  language: python
  name: python3
---

## Problem

+++

In this exercise you will be fitting model to data. The data was generated by drawing some random integers (days) and calculating same function for each number. Then  gaussian noise with  mean zero and some fixed variance was added to each reasult. Additionally for some days "background noise"(outliers) was simulated  by drawing values from gaussian distributions with some fixed mean and variance.

+++

1. Load and plot data from file `regression.txt`

+++

## Polynomial fit

+++

2. Fit polynomial of the first, second, third and fourth degree to the data. Use the `curve_fit` function from  `scipy.optimize`. For each fit calculate the Mean squared error (MSE). Which fit is the "best"?

+++

## Bayesian fit

+++

3. Construct a PyMC model for the polynomial fit to the data. Use the $\frac{1}{\sigma}$ prior for the noise standard deviation parameter. Use wide gaussian priors for the polynomial coeficients.

+++

4. Use `find_MAP` function to fit the model to the data. Compare the results with the result of `curve_fit`.

+++

5. Generate the posterior samples for the model parameters using `sample` function. Did sampler converge? Were you able to use the NUTS sampler? If not use the Metropolis sampler.

+++

## Scaled values

+++

6. Rescale the days (firs column) variable so it takes the values in the range [-1,1].

+++

7. Repeat sampling using the rescaled  data. Does the sampler converges now? Calculate the means of the polynomial coefficients.

+++

## Errors

+++

8. For each model plot the predicted fitted function together with standard errors:

    1. Draw a posterior sample of polynomial coefficients. 
    2. For each set o coefficients in the sample and each day calculate the value of the polynomial. 
    3. For each day calculate the  mean and standard deviation of obtained results.

+++

## Comparing models

+++

9. Compare models with polynomials of different degrees using the WAIC criterion.
